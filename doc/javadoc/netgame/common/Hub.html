<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_79) on Tue Sep 06 22:55:51 EDT 2016 -->
<title>Hub</title>
<meta name="date" content="2016-09-06">
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Hub";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../netgame/common/ForwardedMessage.html" title="class in netgame.common"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../index.html?netgame/common/Hub.html" target="_top">Frames</a></li>
<li><a href="Hub.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">netgame.common</div>
<h2 title="Class Hub" class="title">Class Hub</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>netgame.common.Hub</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>Direct Known Subclasses:</dt>
<dd><a href="../../netgame/fivecarddraw/PokerHub.html" title="class in netgame.fivecarddraw">PokerHub</a>, <a href="../../netgame/tictactoe/TicTacToeGameHub.html" title="class in netgame.tictactoe">TicTacToeGameHub</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">Hub</span>
extends java.lang.Object</pre>
<div class="block">A Hub is a server for a "netgame".  When a Hub is created, it will
 listen for connection requests from clients on a specified port.
 The clients are the players in the game.  Each player is identified
 by an ID number that is assigned by the hub when the playerTerminal connects.
 Clients are defined by subclasses of the class netgame.commen.Client.
 <p>A Hub is a "message center" that can send and receive messages.
 A message can be any non-null object that implements the Serializable interface.
 Many standard classes, including String, do this.  (So, a message might
 simply be a string.)  When a message  is received, the protected method
 messageReceived(sender,message) is called.  In this class, this method
 simply wraps the message in a ForwardedMessage, which it then
 sends to all connected clients.  That is, the Hub acts as a passive
 forwarder of messages.  Subclasses will usually override this method
 and will generally add other functionality to the Hub as well.
 <p>The sendToAll(msg) method sends a message to all connected clients.
 The sendToOne(playerID,msg) method will send the message to just the
 playerTerminal with the specified ID number.  If the same object is transmitted
 more than once, it might be necessary to use the resetOutput() or
 setAutoReset(true) methods.  See those methods for details.
 <p>(Certain messages that are defined by package private classes in
 the package netgame.common, are for internal use only.  These messages
 do not result in a call to messageReceived, and they are not seen
 by clients.)
 
 <p>The communication protocol that is used internally goes as follows:
  <ul>
  <li>When the server receives a connection request, it expects to
  read a string from the playerTerminal.  The string is "Hello Hub".</li>
  <li>The server responds by sending an object of type Integer 
  representing the unique ID number that has been assigned to the playerTerminal.
  Clients are assigned the IDs 1, 2, 3, ..., in the order they connect.</li>
  <li>The extraHandshake() method is called.  This method does nothing
  in this class, but subclasses of Hub can override to do extra setup
  or checking before the connection is considered to be created.
  Note that if extraHandshake() throws an error, then the playerTerminal is
  never considered connected, but that playerTerminal's ID will not be reused.</li>
  <li>All connected clients, including the one that has just connected,
  are notified of the new playerTerminal.  (The playerConnected() method in
  the playerTerminal will be called.)</li>
  <li>Once a playerTerminal has successfully connected, the playerTerminal can send messages to
  the server.  Messages received from a playerTerminal are passed to the
  messageReceived() method.</li>
  <li>If the playerTerminal's disconnect() method is called, the hub is notified,
  and it in turn notifies all connected clients, not including the one
  that just disconnected.  (The clients' playerDisconnected() method
  is called.)</li>
  <li>If the hub's shutDownHub() method is called, all the clients
  will be notified, and the ServerSocket, if any still exists, is closed down.  
  One second later, any connection that has not closed normally is closed.
  </ul></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../netgame/common/Hub.html#Hub(int)">Hub</a></strong>(int&nbsp;port)</code>
<div class="block">Creates a Hub listening on a specified port, and starts a thread for
 processing messages that are received from clients.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#extraHandshake(int,%20java.io.ObjectInputStream,%20java.io.ObjectOutputStream)">extraHandshake</a></strong>(int&nbsp;playerID,
              java.io.ObjectInputStream&nbsp;in,
              java.io.ObjectOutputStream&nbsp;out)</code>
<div class="block">This method is called after a connection request has been received to do 
 extra checking or set up before the connection is fully established.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#getAutoreset()">getAutoreset</a></strong>()</code>
<div class="block">Returns the value of the autoreset property.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int[]</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#getPlayerList()">getPlayerList</a></strong>()</code>
<div class="block">Gets a list of ID numbers of currently connected clients.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#messageReceived(int,%20java.lang.Object)">messageReceived</a></strong>(int&nbsp;playerID,
               java.lang.Object&nbsp;message)</code>
<div class="block">This method is called when a message is received from one of the 
 connected players.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#playerConnected(int)">playerConnected</a></strong>(int&nbsp;playerID)</code>
<div class="block">This method is called just after a player has connected.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#playerDisconnected(int)">playerDisconnected</a></strong>(int&nbsp;playerID)</code>
<div class="block">This method is called just after a player has disconnected.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#resetOutput()">resetOutput</a></strong>()</code>
<div class="block">Resets all output streams, after any messages currently in the output queue
 have been sent.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#restartServer(int)">restartServer</a></strong>(int&nbsp;port)</code>
<div class="block">Restarts listening and accepting new clients.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#sendToAll(java.lang.Object)">sendToAll</a></strong>(java.lang.Object&nbsp;message)</code>
<div class="block">Sends a specified non-null Object as a message to all connected playerTerminal.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#sendToOne(int,%20java.lang.Object)">sendToOne</a></strong>(int&nbsp;recipientID,
         java.lang.Object&nbsp;message)</code>
<div class="block">Sends a specified non-null Object as a message to one connected playerTerminal.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#setAutoreset(boolean)">setAutoreset</a></strong>(boolean&nbsp;auto)</code>
<div class="block">If the autoreset property is set to true, then all output streams will be reset
 before every object transmission.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#shutDownHub()">shutDownHub</a></strong>()</code>
<div class="block">Disconnects all currently connected clients and stops accepting new playerTerminal
  requests.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../netgame/common/Hub.html#shutdownServerSocket()">shutdownServerSocket</a></strong>()</code>
<div class="block">Stops listening, without disconnecting any currently connected clients.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Hub(int)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Hub</h4>
<pre>public&nbsp;Hub(int&nbsp;port)
    throws java.io.IOException</pre>
<div class="block">Creates a Hub listening on a specified port, and starts a thread for
 processing messages that are received from clients.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>port</code> - the port on which the server will listen.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if it is not possible to create a listening socket on the specified port.</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="messageReceived(int, java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>messageReceived</h4>
<pre>protected&nbsp;void&nbsp;messageReceived(int&nbsp;playerID,
                   java.lang.Object&nbsp;message)</pre>
<div class="block">This method is called when a message is received from one of the 
 connected players.  The method in this class simply wraps the message,
 along with the ID of the sender of the message, into a message of type
 ForwardedMessage and then sends that ForwardedMessage to all connected 
 players, including the one who sent the original message.  This
 behavior will often be overridden in subclasses.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>playerID</code> - The ID number of the player who sent the message.</dd><dd><code>message</code> - The message that was received from the player.</dd></dl>
</li>
</ul>
<a name="playerConnected(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>playerConnected</h4>
<pre>protected&nbsp;void&nbsp;playerConnected(int&nbsp;playerID)</pre>
<div class="block">This method is called just after a player has connected.
 Note that getPlayerList() can be called to get a list
 of connected players.  The method in this class does nothing.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>playerID</code> - the ID number of the new player.</dd></dl>
</li>
</ul>
<a name="playerDisconnected(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>playerDisconnected</h4>
<pre>protected&nbsp;void&nbsp;playerDisconnected(int&nbsp;playerID)</pre>
<div class="block">This method is called just after a player has disconnected.
 Note that getPlayerList() can be called to get a list
 of connected players.  The method in this class does nothing.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>playerID</code> - the ID number of the new player.</dd></dl>
</li>
</ul>
<a name="extraHandshake(int, java.io.ObjectInputStream, java.io.ObjectOutputStream)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>extraHandshake</h4>
<pre>protected&nbsp;void&nbsp;extraHandshake(int&nbsp;playerID,
                  java.io.ObjectInputStream&nbsp;in,
                  java.io.ObjectOutputStream&nbsp;out)
                       throws java.io.IOException</pre>
<div class="block">This method is called after a connection request has been received to do 
 extra checking or set up before the connection is fully established.
 It is called after the playerID has been transmitted to the playerTerminal.
 If this method throws an IOException, then the connection is closed
 and the player is never added to the list of players.  The method in
 this class does nothing.   The playerTerminal and the hub must both be programmed
 with the same handshake protocol.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>playerID</code> - the ID number of the player who is connecting.</dd><dd><code>in</code> - a stream from which messages from the playerTerminal can be read.</dd><dd><code>out</code> - a stream to which message to the playerTerminal can be written.  After writing
    a message to this stream, it is important to call out.flush() to make sure
    that the message is actually transmitted.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - should be thrown if some error occurs that should
 prevent the connection from being established.</dd></dl>
</li>
</ul>
<a name="getPlayerList()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPlayerList</h4>
<pre>public&nbsp;int[]&nbsp;getPlayerList()</pre>
<div class="block">Gets a list of ID numbers of currently connected clients.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>an array containing the ID numbers of all the connected clients.
 The array is newly created each time this method is called.</dd></dl>
</li>
</ul>
<a name="shutdownServerSocket()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutdownServerSocket</h4>
<pre>public&nbsp;void&nbsp;shutdownServerSocket()</pre>
<div class="block">Stops listening, without disconnecting any currently connected clients.
 You might do this, for example, if some maximum number of player connections has
 been reached, as when a game only allows two players.</div>
</li>
</ul>
<a name="restartServer(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>restartServer</h4>
<pre>public&nbsp;void&nbsp;restartServer(int&nbsp;port)
                   throws java.io.IOException</pre>
<div class="block">Restarts listening and accepting new clients.  This would only be used if
 the shutDownHub() method has been called previously.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>port</code> - the port on which the server should listen.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code> - if it is impossible to create a listening socket on the specified port.</dd></dl>
</li>
</ul>
<a name="shutDownHub()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>shutDownHub</h4>
<pre>public&nbsp;void&nbsp;shutDownHub()</pre>
<div class="block">Disconnects all currently connected clients and stops accepting new playerTerminal
  requests.  It is still possible to restart listening after this method has
  been called, by calling the restartServer() method.</div>
</li>
</ul>
<a name="sendToAll(java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendToAll</h4>
<pre>public&nbsp;void&nbsp;sendToAll(java.lang.Object&nbsp;message)</pre>
<div class="block">Sends a specified non-null Object as a message to all connected playerTerminal.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - the message to be sent to all connected clients.  This object must
 implement the Serializable interface.  Messages must not be null.</dd></dl>
</li>
</ul>
<a name="sendToOne(int, java.lang.Object)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendToOne</h4>
<pre>public&nbsp;boolean&nbsp;sendToOne(int&nbsp;recipientID,
                java.lang.Object&nbsp;message)</pre>
<div class="block">Sends a specified non-null Object as a message to one connected playerTerminal.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>recipientID</code> - The ID number of the player to whom the message is
 to be sent.  If there is no such player, then the method returns the 
 value false.</dd><dd><code>message</code> - the message to be sent to all connected clients.  This object must
 implement the Serializable interface.  Messages must not be null.</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the specified recipient exists, false if not.</dd></dl>
</li>
</ul>
<a name="resetOutput()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetOutput</h4>
<pre>public&nbsp;void&nbsp;resetOutput()</pre>
<div class="block">Resets all output streams, after any messages currently in the output queue
 have been sent.  The stream only needs to be reset in one case:  If the same
 object is transmitted more than once, and changes have been made to it
 between transmissions.  The reason for this is that ObjectOutputStreams are
 optimized for sending objects that don't change -- if the same object is sent
 twice it will not actually be transmitted the second time, unless the stream
 has been reset in the meantime.</div>
</li>
</ul>
<a name="setAutoreset(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setAutoreset</h4>
<pre>public&nbsp;void&nbsp;setAutoreset(boolean&nbsp;auto)</pre>
<div class="block">If the autoreset property is set to true, then all output streams will be reset
 before every object transmission.  Use this if the same object is going to be
 continually changed and retransmitted.  See the resetOutput() method for more
 information on resetting the output stream.  The default value is false.</div>
</li>
</ul>
<a name="getAutoreset()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getAutoreset</h4>
<pre>public&nbsp;boolean&nbsp;getAutoreset()</pre>
<div class="block">Returns the value of the autoreset property.</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-files/index-1.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../netgame/common/ForwardedMessage.html" title="class in netgame.common"><span class="strong">Prev Class</span></a></li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../index.html?netgame/common/Hub.html" target="_top">Frames</a></li>
<li><a href="Hub.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
